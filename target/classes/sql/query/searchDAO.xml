<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	 PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.inno.odag.mapper">
  <select id="search" parameterType="SearchDto" resultType="SearchDto">
    SELECT search_no
         , search_keyword
         , user_no
         , search_count
         , search_time
      FROM search
     <where>
       <if test="searchNo != 0 and sarchNo > 0">
         AND search_no = #{searchNo}
       </if>
       <if test="searchKeyword != null and searchKeyword != ''">
         AND search_keyword = #{searchKeyword}
       </if>
       <if test="userNo != 0 and userNo > 0">
         AND user_no = #{userNo}
       </if>
     </where>
     ORDER BY search_time DESC
  </select>

  <insert id="searchInsert" parameterType="SearchDto">
    INSERT INTO search(
                        search_no
                      , search_keyword
                      , user_no
                      , search_time
                     ) VALUES (
                        #{searchNo}
                      , #{searchKeyword}
                      , #{userNo}
                      , #{searchTime}
                     )
  </insert>

  <update id="searchUpdate" parameterType="SearchDto">
    UPDATE search
      <set>
        <if test="searchKeyword != null and searchKeyword != ''">
          search_keyword = #{searchKeyword},
        </if>
        <if test="userNo != 0 and userNo > 0">
          user_no = #{userNo},
        </if>
        <if test="searchCount != 0 and searchCount > 0">
          search_count = #{searchCount},
        </if>
        <if test="searchCount != 0 and searchCount > 0">
          search_time = #{searchTime},
        </if>
      </set>
      WHERE search_keyword = #{searchKeyword}
  </update>

  <delete id="searchDelete" parameterType="SearchDto">
    DELETE FROM search WHERE search_no = #{searchNo}
  </delete>

</mapper>